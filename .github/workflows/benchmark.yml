# on: [push, pull_request]
name: Benchmark
on:
  push:
    branches: [ master ]

jobs:
  benchmark:
    runs-on: ubuntu-latest
    steps:
    - name: checkout
      uses: actions/checkout@v1
      with:
        fetch-depth: 1
    - name: gobenchdata to gh-pages
      uses: bobheadxi/gobenchdata@v0.5.1
      with:
        PRUNE_COUNT: 30
        GO_TEST_FLAGS: -cpu 1,2
      env:
        GITHUB_TOKEN: ${{ secrets.BENCHMARK_TOKEN }}
# name: Benchmark
# jobs:
#   Compare:
#     runs-on: ubuntu-latest
#     steps:
#     - name: Install Go
#       uses: actions/setup-go@v1
#       with:
#         go-version: ${{ matrix.go-version }}
#     - name: Fetch Repository
#       uses: actions/checkout@v2
#     - name: Run Benchmark
#       run: go test -benchmem -run=^$ -bench . | tee output.txt
#     - name: Get Previous Benchmark Results
#       uses: actions/cache@v1
#       with:
#         path: ./cache
#         key: ${{ runner.os }}-benchmark
#     - name: Save Benchmark Results
#       uses: rhysd/github-action-benchmark@v1
#       with:
#         tool: 'go'
#         output-file-path: output.txt
#         github-token: ${{ secrets.BENCHMARK_TOKEN }}
#         fail-on-alert: true
#         comment-on-alert: true
#         auto-push: true

